<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLASSYæ¥­å‹™ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - å·æº€ã•ã‚“å°‚ç”¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #3b82f6;
            --secondary-blue: #60a5fa;
            --light-blue: #dbeafe;
            --cyan: #06b6d4;
            --light-cyan: #cffafe;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid rgba(148, 163, 184, 0.1);
        }
        
        .card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            font-weight: 500;
            border-radius: 12px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 14px;
            min-height: 48px;
            min-width: 120px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
        }
        
        .btn-cyan {
            background: linear-gradient(135deg, var(--cyan), #22d3ee);
            color: white;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
        }
        
        .btn-cyan:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(6, 182, 212, 0.4);
        }
        
        .btn-outline {
            background: white;
            color: var(--primary-blue);
            border: 2px solid var(--light-blue);
        }
        
        .btn-outline:hover {
            background: var(--light-blue);
            border-color: var(--primary-blue);
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            margin: 4px 0;
            border-radius: 12px;
            color: #64748b;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            font-weight: 500;
        }
        
        .nav-item:hover {
            background: var(--light-blue);
            color: var(--primary-blue);
            transform: translateX(4px);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .stat-card {
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue), var(--cyan));
        }
        
        .stat-card:hover {
            transform: scale(1.02);
        }
        
        .progress-bar {
            background: #e2e8f0;
            border-radius: 8px;
            height: 8px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 8px;
            transition: width 0.5s ease;
        }
        
        .progress-green { background: linear-gradient(90deg, #10b981, #34d399); }
        .progress-yellow { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .progress-red { background: linear-gradient(90deg, #ef4444, #f87171); }
        
        .task-item {
            padding: 16px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            background: white;
        }
        
        .task-item:hover {
            border-color: var(--primary-blue);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
        }
        
        .task-completed {
            opacity: 0.6;
            background: #f8fafc;
        }
        
        .task-completed .task-text {
            text-decoration: line-through;
            color: #64748b;
        }
        
        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .badge-green { background: #dcfce7; color: #166534; }
        .badge-yellow { background: #fef3c7; color: #92400e; }
        .badge-red { background: #fecaca; color: #991b1b; }
        .badge-blue { background: var(--light-blue); color: var(--primary-blue); }
        .badge-cyan { background: var(--light-cyan); color: #0e7490; }
        
        .calendar-day {
            min-height: 80px;
            border: 1px solid #e2e8f0;
            padding: 8px;
            transition: all 0.3s ease;
            background: white;
        }
        
        .calendar-day:hover {
            background: #f8fafc;
            border-color: var(--primary-blue);
        }
        
        .calendar-today {
            background: var(--light-blue);
            border-color: var(--primary-blue);
            font-weight: 600;
        }
        
        .event-item {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            margin: 2px 0;
            font-weight: 500;
        }
        
        .event-meeting { background: var(--light-blue); color: var(--primary-blue); }
        .event-shooting { background: #dcfce7; color: #166534; }
        .event-holiday { background: #fecaca; color: #991b1b; }
        .event-deadline { background: #fed7aa; color: #9a3412; }
        
        .chart-container {
            position: relative;
            height: 350px;
            width: 100%;
        }
        
        .hidden { display: none !important; }
        
        .sidebar {
            position: fixed;
            top: 0;
            left: -320px;
            width: 320px;
            height: 100vh;
            background: white;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 4px 0 24px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar.active {
            left: 0;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        @media (min-width: 768px) {
            .sidebar {
                position: relative;
                left: 0;
                box-shadow: none;
                border-right: 1px solid #e2e8f0;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
    <div id="overlay" class="overlay" onclick="closeSidebar()"></div>
    
    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    <div id="sidebar" class="sidebar">
        <div class="p-6">
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h2 class="text-xl font-bold text-gray-900">CLASSY</h2>
                    <p class="text-sm text-gray-600">æ¥­å‹™ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</p>
                    <p class="text-xs text-blue-600 font-medium">å·æº€ã•ã‚“å°‚ç”¨</p>
                </div>
                <button onclick="closeSidebar()" class="md:hidden text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <nav class="space-y-2">
                <div class="nav-item active" onclick="showPage('dashboard')">
                    <i class="fas fa-home mr-3 text-lg"></i>
                    <span>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span>
                </div>
                <div class="nav-item" onclick="showPage('sales')">
                    <i class="fas fa-chart-line mr-3 text-lg"></i>
                    <span>å£²ä¸Šåˆ†æ</span>
                </div>
                <div class="nav-item" onclick="showPage('reports')">
                    <i class="fas fa-file-alt mr-3 text-lg"></i>
                    <span>ä¼šè­°è³‡æ–™</span>
                </div>
                <div class="nav-item" onclick="showPage('calendar')">
                    <i class="fas fa-calendar mr-3 text-lg"></i>
                    <span>ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</span>
                </div>
            </nav>
            
            <div class="mt-8 p-4 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-12 border border-blue-100">
                <div class="text-center">
                    <div class="text-2xl mb-2">ğŸ“Š</div>
                    <p class="text-sm font-medium text-blue-800">ãƒ‡ãƒ¼ã‚¿æœ€çµ‚æ›´æ–°</p>
                    <p class="text-xs text-blue-600" id="lastUpdate">2024-06-26 14:30</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="min-h-screen md:ml-320">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="card m-4 mb-6">
            <div class="p-4 flex items-center justify-between">
                <div class="flex items-center">
                    <button onclick="toggleSidebar()" class="md:hidden mr-4 text-gray-600 hover:text-gray-800">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">CLASSYæ¥­å‹™ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
                        <p class="text-sm text-gray-600" id="currentPageTitle">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="text-right hidden sm:block">
                        <div class="font-semibold text-gray-900" id="currentDate"></div>
                        <div class="text-sm text-blue-600" id="currentTime"></div>
                    </div>
                    <button class="btn btn-primary" onclick="syncGoogleData()">
                        <i class="fas fa-sync-alt mr-2"></i>
                        <span class="hidden sm:inline">GoogleåŒæœŸ</span>
                    </button>
                </div>
            </div>
        </header>
        
        <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ -->
        <div id="dashboardPage" class="page-content px-4 fade-in">
            <!-- æœ¬æ—¥ã®ã‚„ã‚‹ã“ã¨ãƒªã‚¹ãƒˆ -->
            <div class="card p-6 mb-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-tasks mr-3 text-blue-600"></i>æœ¬æ—¥ã®ã‚„ã‚‹ã“ã¨ãƒªã‚¹ãƒˆ
                    </h3>
                    <button class="btn btn-outline" onclick="refreshTasks()">
                        <i class="fas fa-refresh mr-2"></i>æ›´æ–°
                    </button>
                </div>
                <div id="todayTasks" class="space-y-3">
                    <div class="task-item">
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-4 w-5 h-5 text-blue-600 rounded" onchange="toggleTask(this)">
                            <div class="flex-1">
                                <div class="task-text font-medium">å¯®ã®é€€å»ç¢ºèªï¼ˆç”°ä¸­ã•ã‚“ï¼‰</div>
                                <div class="text-sm text-gray-500">10:00 - å„ªå…ˆåº¦ï¼šé«˜</div>
                            </div>
                            <span class="badge badge-red">é‡è¦</span>
                        </div>
                    </div>
                    <div class="task-item">
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-4 w-5 h-5 text-blue-600 rounded" onchange="toggleTask(this)">
                            <div class="flex-1">
                                <div class="task-text font-medium">åå¤å±‹åº—å£²ä¸Šç¢ºèªãƒ»åˆ†æ</div>
                                <div class="text-sm text-gray-500">15:00 - ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ›´æ–°</div>
                            </div>
                            <span class="badge badge-yellow">é€šå¸¸</span>
                        </div>
                    </div>
                    <div class="task-item task-completed">
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-4 w-5 h-5 text-blue-600 rounded" checked onchange="toggleTask(this)">
                            <div class="flex-1">
                                <div class="task-text font-medium">æŠ•ç¨¿çŠ¶æ³ãƒã‚§ãƒƒã‚¯ï¼ˆå…¨åº—èˆ—ï¼‰</div>
                                <div class="text-sm text-gray-500">09:00 - å®Œäº†æ¸ˆã¿</div>
                            </div>
                            <span class="badge badge-green">å®Œäº†</span>
                        </div>
                    </div>
                    <div class="task-item">
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-4 w-5 h-5 text-blue-600 rounded" onchange="toggleTask(this)">
                            <div class="flex-1">
                                <div class="task-text font-medium">ä¼šè­°è³‡æ–™æº–å‚™ï¼ˆæœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆï¼‰</div>
                                <div class="text-sm text-gray-500">17:00 - æ˜æ—¥ã®ä¼šè­°ç”¨</div>
                            </div>
                            <span class="badge badge-blue">ä¼šè­°</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- åº—èˆ—åˆ¥æŠ•ç¨¿çŠ¶æ³ãƒ»å£²ä¸Šé€Ÿå ± -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="card p-6">
                    <h3 class="text-lg font-semibold mb-6 text-gray-900 flex items-center">
                        <i class="fas fa-camera mr-3 text-green-600"></i>åº—èˆ—åˆ¥æŠ•ç¨¿çŠ¶æ³
                    </h3>
                    <div class="space-y-4">
                        <div class="p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-12 border border-green-100">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-gray-900">åå¤å±‹åº—</span>
                                <span class="text-green-600 font-bold">24/30</span>
                            </div>
                            <div class="progress-bar mb-2">
                                <div class="progress-fill progress-green" style="width: 80%"></div>
                            </div>
                            <div class="text-sm text-gray-600">é”æˆç‡: 80% | ç›®æ¨™ã¾ã§6ä»¶</div>
                        </div>
                        
                        <div class="p-4 bg-gradient-to-r from-yellow-50 to-amber-50 rounded-12 border border-yellow-100">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-gray-900">éŒ¦åº—</span>
                                <span class="text-yellow-600 font-bold">18/30</span>
                            </div>
                            <div class="progress-bar mb-2">
                                <div class="progress-fill progress-yellow" style="width: 60%"></div>
                            </div>
                            <div class="text-sm text-gray-600">é”æˆç‡: 60% | ç›®æ¨™ã¾ã§12ä»¶</div>
                        </div>
                        
                        <div class="p-4 bg-gradient-to-r from-red-50 to-rose-50 rounded-12 border border-red-100">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-gray-900">æ¨ªæµœåº—</span>
                                <span class="text-red-600 font-bold">12/30</span>
                            </div>
                            <div class="progress-bar mb-2">
                                <div class="progress-fill progress-red" style="width: 40%"></div>
                            </div>
                            <div class="text-sm text-gray-600">é”æˆç‡: 40% | ç›®æ¨™ã¾ã§18ä»¶</div>
                        </div>
                    </div>
                </div>
                
                <!-- å£²ä¸Šé€Ÿå ± -->
                <div class="card p-6">
                    <h3 class="text-lg font-semibold mb-6 text-gray-900 flex items-center">
                        <i class="fas fa-yen-sign mr-3 text-blue-600"></i>æœ¬æ—¥ã®å£²ä¸Šé€Ÿå ±
                    </h3>
                    <div class="space-y-4">
                        <div class="stat-card bg-gradient-to-br from-blue-50 to-cyan-50 rounded-12 border border-blue-100">
                            <div class="text-3xl font-bold text-blue-600">Â¥2,680,000</div>
                            <div class="text-sm text-blue-800 font-medium">æœ¬æ—¥ã®ç·å£²ä¸Š</div>
                            <div class="text-xs text-green-600 mt-2 flex items-center justify-center">
                                <i class="fas fa-arrow-up mr-1"></i>æ˜¨æ—¥æ¯” +15.2%
                            </div>
                        </div>
                        
                        <div class="stat-card bg-gradient-to-br from-green-50 to-emerald-50 rounded-12 border border-green-100">
                            <div class="text-2xl font-bold text-green-600">Â¥82,500,000</div>
                            <div class="text-sm text-green-800 font-medium">ä»Šæœˆç´¯è¨ˆ</div>
                            <div class="text-xs text-green-600 mt-2">ç›®æ¨™é”æˆç‡: 92.1%</div>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div class="p-3 bg-white rounded-lg border border-gray-100">
                                <div class="text-lg font-bold text-purple-600">Â¥950K</div>
                                <div class="text-xs text-gray-600">åå¤å±‹</div>
                            </div>
                            <div class="p-3 bg-white rounded-lg border border-gray-100">
                                <div class="text-lg font-bold text-indigo-600">Â¥820K</div>
                                <div class="text-xs text-gray-600">éŒ¦</div>
                            </div>
                            <div class="p-3 bg-white rounded-lg border border-gray-100">
                                <div class="text-lg font-bold text-pink-600">Â¥910K</div>
                                <div class="text-xs text-gray-600">æ¨ªæµœ</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ä»Šé€±ã®äºˆå®š -->
            <div class="card p-6">
                <h3 class="text-lg font-semibold mb-6 text-gray-900 flex items-center">
                    <i class="fas fa-calendar mr-3 text-indigo-600"></i>ä»Šé€±ã®äºˆå®š
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-7 gap-3">
                    <div class="calendar-day calendar-today rounded-12">
                        <div class="font-semibold text-blue-800 mb-2">æœˆ 26</div>
                        <div class="event-item event-meeting">æœˆæ¬¡ä¼šè­°</div>
                        <div class="event-item event-deadline">å£²ä¸Šå ±å‘Š</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-gray-800 mb-2">ç« 27</div>
                        <div class="text-sm text-gray-500">äºˆå®šãªã—</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-gray-800 mb-2">æ°´ 28</div>
                        <div class="event-item event-shooting">æ’®å½±</div>
                        <div class="event-item event-meeting">åº—é•·ä¼šè­°</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-gray-800 mb-2">æœ¨ 29</div>
                        <div class="event-item event-deadline">çµ¦ä¸å‡¦ç†</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-gray-800 mb-2">é‡‘ 30</div>
                        <div class="event-item event-meeting">ç›£æŸ»</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-red-800 mb-2">åœŸ 1</div>
                        <div class="event-item event-holiday">ä¼‘æ¥­æ—¥</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-red-800 mb-2">æ—¥ 2</div>
                        <div class="event-item event-holiday">ä¼‘æ¥­æ—¥</div>
                    </div>
                </div>
                
                <div class="mt-6 flex flex-wrap gap-4 text-sm">
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-blue-400 rounded mr-2"></div>
                        <span>ä¼šè­°</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-green-400 rounded mr-2"></div>
                        <span>æ’®å½±</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-red-400 rounded mr-2"></div>
                        <span>ä¼‘æ¥­</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-orange-400 rounded mr-2"></div>
                        <span>æå‡ºæœŸé™</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- å£²ä¸Šåˆ†æãƒšãƒ¼ã‚¸ -->
        <div id="salesPage" class="page-content px-4 hidden">
            <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <div class="card stat-card bg-gradient-to-br from-blue-50 to-cyan-50">
                    <div class="text-3xl font-bold text-blue-600">Â¥280M</div>
                    <div class="text-sm text-blue-800 font-medium">ä»Šæœˆå£²ä¸Š</div>
                    <div class="text-xs text-green-600 mt-2 flex items-center justify-center">
                        <i class="fas fa-arrow-up mr-1"></i>å‰å¹´åŒæœŸæ¯” +12.5%
                    </div>
                </div>
                <div class="card stat-card bg-gradient-to-br from-green-50 to-emerald-50">
                    <div class="text-3xl font-bold text-green-600">96.2%</div>
                    <div class="text-sm text-green-800 font-medium">ç›®æ¨™é”æˆç‡</div>
                    <div class="text-xs text-green-600 mt-2">ç›®æ¨™: Â¥291M</div>
                </div>
                <div class="card stat-card bg-gradient-to-br from-purple-50 to-violet-50">
                    <div class="text-3xl font-bold text-purple-600">3/3</div>
                    <div class="text-sm text-purple-800 font-medium">ç›®æ¨™é”æˆåº—èˆ—</div>
                    <div class="text-xs text-purple-600 mt-2">å…¨åº—èˆ—é”æˆä¸­</div>
                </div>
                <div class="card stat-card bg-gradient-to-br from-orange-50 to-amber-50">
                    <div class="text-3xl font-bold text-orange-600">Â¥93.3M</div>
                    <div class="text-sm text-orange-800 font-medium">åº—èˆ—å¹³å‡å£²ä¸Š</div>
                    <div class="text-xs text-orange-600 mt-2">æœˆå¹³å‡</div>
                </div>
            </div>
            
            <!-- ã‚°ãƒ©ãƒ•ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="card p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h4 class="text-lg font-semibold text-gray-900">æœˆåˆ¥ãƒ»é€±åˆ¥å£²ä¸Šæ¨ç§»</h4>
                        <div class="flex space-x-2">
                            <button class="btn btn-outline" onclick="toggleChartType('line')" id="lineChartBtn">ç·šã‚°ãƒ©ãƒ•</button>
                            <button class="btn btn-primary" onclick="toggleChartType('bar')" id="barChartBtn">æ£’ã‚°ãƒ©ãƒ•</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
                
                <div class="card p-6">
                    <h4 class="text-lg font-semibold text-gray-900 mb-6">åº—èˆ—åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆå½“æœˆå£²ä¸Šï¼‰</h4>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gradient-to-r from-yellow-50 to-amber-50 rounded-12 border-l-4 border-yellow-400">
                            <div class="flex items-center">
                                <div class="text-2xl mr-3">ğŸ¥‡</div>
                                <div>
                                    <div class="font-semibold text-gray-900">åå¤å±‹åº—</div>
                                    <div class="text-sm text-gray-600">é”æˆç‡: 105.2%</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-yellow-600 text-lg">Â¥105.2M</div>
                                <div class="text-xs text-green-600">+5.2%</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-gradient-to-r from-gray-50 to-slate-50 rounded-12 border-l-4 border-gray-400">
                            <div class="flex items-center">
                                <div class="text-2xl mr-3">ğŸ¥ˆ</div>
                                <div>
                                    <div class="font-semibold text-gray-900">æ¨ªæµœåº—</div>
                                    <div class="text-sm text-gray-600">é”æˆç‡: 98.1%</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-gray-600 text-lg">Â¥98.1M</div>
                                <div class="text-xs text-yellow-600">-1.9%</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-gradient-to-r from-orange-50 to-amber-50 rounded-12 border-l-4 border-orange-400">
                            <div class="flex items-center">
                                <div class="text-2xl mr-3">ğŸ¥‰</div>
                                <div>
                                    <div class="font-semibold text-gray-900">éŒ¦åº—</div>
                                    <div class="text-sm text-gray-600">é”æˆç‡: 88.7%</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-orange-600 text-lg">Â¥88.7M</div>
                                <div class="text-xs text-red-600">-11.3%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 bg-blue-50 rounded-12 border border-blue-100">
                        <div class="text-sm font-medium text-blue-800 mb-2">å‰å¹´åŒæœŸæ¯”è¼ƒ</div>
                        <div class="text-xs text-blue-600">
                            <i class="fas fa-arrow-up mr-1"></i>å…¨åº—èˆ—åˆè¨ˆ: +12.5% (å‰å¹´åŒæœˆ: Â¥249M)
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å£²ä¸Šç›®æ¨™é”æˆç‡ -->
            <div class="card p-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-6">å£²ä¸Šç›®æ¨™é”æˆç‡ï¼ˆè‰²åˆ†ã‘è¡¨ç¤ºï¼‰</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="p-6 bg-gradient-to-br from-green-50 to-emerald-50 rounded-16 border-2 border-green-200">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-600">105.2%</div>
                            <div class="text-lg font-semibold text-gray-900 mt-2">åå¤å±‹åº—</div>
                            <div class="badge badge-green mt-3">ç›®æ¨™é”æˆ</div>
                            <div class="text-sm text-gray-600 mt-2">ç›®æ¨™: Â¥100M / å®Ÿç¸¾: Â¥105.2M</div>
                        </div>
                    </div>
                    
                    <div class="p-6 bg-gradient-to-br from-yellow-50 to-amber-50 rounded-16 border-2 border-yellow-200">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-yellow-600">88.7%</div>
                            <div class="text-lg font-semibold text-gray-900 mt-2">éŒ¦åº—</div>
                            <div class="badge badge-yellow mt-3">è¦æ³¨æ„</div>
                            <div class="text-sm text-gray-600 mt-2">ç›®æ¨™: Â¥100M / å®Ÿç¸¾: Â¥88.7M</div>
                        </div>
                    </div>
                    
                    <div class="p-6 bg-gradient-to-br from-green-50 to-emerald-50 rounded-16 border-2 border-green-200">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-600">98.1%</div>
                            <div class="text-lg font-semibold text-gray-900 mt-2">æ¨ªæµœåº—</div>
                            <div class="badge badge-green mt-3">é †èª¿</div>
                            <div class="text-sm text-gray-600 mt-2">ç›®æ¨™: Â¥100M / å®Ÿç¸¾: Â¥98.1M</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ä¼šè­°è³‡æ–™ãƒšãƒ¼ã‚¸ -->
        <div id="reportsPage" class="page-content px-4 hidden">
            <div class="card p-6 mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-6">ä¼šè­°è³‡æ–™ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">ğŸ“Š</div>
                        <h4 class="font-semibold text-lg mb-2">å£²ä¸Šã¾ã¨ã‚è³‡æ–™</h4>
                        <p class="text-sm text-gray-600 mb-4">æœˆåˆ¥ãƒ»åº—èˆ—åˆ¥å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã¨åˆ†æ</p>
                        <div class="space-y-2">
                            <button class="btn btn-primary w-full" onclick="downloadReport('sales', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excelå½¢å¼
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('sales', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDFå½¢å¼
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">ğŸ </div>
                        <h4 class="font-semibold text-lg mb-2">å¯®ç®¡ç†è³‡æ–™</h4>
                        <p class="text-sm text-gray-600 mb-4">å…¥å±…çŠ¶æ³ãƒ»é€€å»äºˆå®šãƒ»ç®¡ç†çŠ¶æ³</p>
                        <div class="space-y-2">
                            <button class="btn btn-primary w-full" onclick="downloadReport('dormitory', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excelå½¢å¼
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('dormitory', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDFå½¢å¼
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">ğŸ“±</div>
                        <h4 class="font-semibold text-lg mb-2">æŠ•ç¨¿ã¾ã¨ã‚è³‡æ–™</h4>
                        <p class="text-sm text-gray-600 mb-4">æŠ•ç¨¿æ•°ãƒ»é”æˆç‡ãƒ»åˆ†æãƒ‡ãƒ¼ã‚¿</p>
                        <div class="space-y-2">
                            <button class="btn btn-primary w-full" onclick="downloadReport('posts', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excelå½¢å¼
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('posts', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDFå½¢å¼
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">ğŸ“‹</div>
                        <h4 class="font-semibold text-lg mb-2">ç·åˆãƒ¬ãƒãƒ¼ãƒˆ</h4>
                        <p class="text-sm text-gray-600 mb-4">å…¨æ¥­å‹™çµ±åˆãƒ»çµŒå–¶ä¼šè­°ç”¨</p>
                        <div class="space-y-2">
                            <button class="btn btn-cyan w-full" onclick="downloadReport('comprehensive', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excelå½¢å¼
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('comprehensive', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDFå½¢å¼
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">ğŸ“…</div>
                        <h4 class="font-semibold text-lg mb-2">ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è³‡æ–™</h4>
                        <p class="text-sm text-gray-600 mb-4">äºˆå®šè¡¨ãƒ»ä¼šè­°ãƒ»æ’®å½±ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</p>
                        <div class="space-y-2">
                            <button class="btn btn-primary w-full" onclick="downloadReport('schedule', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excelå½¢å¼
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('schedule', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDFå½¢å¼
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">ğŸ¯</div>
                        <h4 class="font-semibold text-lg mb-2">æœˆæœ«ãƒ‡ãƒ¼ã‚¿</h4>
                        <p class="text-sm text-gray-600 mb-4">æœˆæœ«ç· ã‚ãƒ»å…¨ãƒ‡ãƒ¼ã‚¿ä¸€æ‹¬å‡ºåŠ›</p>
                        <div class="space-y-2">
                            <button class="btn btn-cyan w-full" onclick="downloadMonthEndReport()">
                                <i class="fas fa-download mr-2"></i>ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                            </button>
                            <div class="text-xs text-gray-500 mt-2">
                                å£²ä¸Šãƒ»å¯®ãƒ»æŠ•ç¨¿ãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- æœ€è¿‘ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å±¥æ­´ -->
            <div class="card p-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-4">æœ€è¿‘ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å±¥æ­´</h4>
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-file-excel text-green-600 mr-3"></i>
                            <div>
                                <div class="font-medium">å£²ä¸Šã¾ã¨ã‚è³‡æ–™_2024å¹´6æœˆ.xlsx</div>
                                <div class="text-sm text-gray-500">2024-06-26 14:30</div>
                            </div>
                        </div>
                        <button class="text-blue-600 hover:text-blue-800">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-file-pdf text-red-600 mr-3"></i>
                            <div>
                                <div class="font-medium">ç·åˆãƒ¬ãƒãƒ¼ãƒˆ_2024å¹´6æœˆ.pdf</div>
                                <div class="text-sm text-gray-500">2024-06-25 16:45</div>
                            </div>
                        </div>
                        <button class="text-blue-600 hover:text-blue-800">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒšãƒ¼ã‚¸ -->
        <div id="calendarPage" class="page-content px-4 hidden">
            <div class="card p-6 mb-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4 md:mb-0">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h3>
                    <div class="flex flex-wrap gap-2">
                        <button class="btn btn-primary" onclick="addEvent()">
                            <i class="fas fa-plus mr-2"></i>äºˆå®šè¿½åŠ 
                        </button>
                        <button class="btn btn-outline" onclick="filterEvents('all')" id="filterAll">å…¨äºˆå®š</button>
                        <button class="btn btn-outline" onclick="filterEvents('common')" id="filterCommon">å…±é€šäºˆå®š</button>
                        <button class="btn btn-outline" onclick="filterEvents('individual')" id="filterIndividual">å€‹åˆ¥äºˆå®š</button>
                        <button class="btn btn-cyan" onclick="syncGoogleCalendar()">
                            <i class="fas fa-sync mr-2"></i>GoogleåŒæœŸ
                        </button>
                    </div>
                </div>
                
                <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="text-xl font-semibold text-gray-900">2024å¹´6æœˆ</h4>
                        <div class="flex space-x-2">
                            <button class="btn btn-outline" onclick="previousMonth()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="btn btn-outline" onclick="nextMonth()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-1 mb-2">
                        <div class="p-3 text-center font-semibold bg-red-50 text-red-800 rounded-lg">æ—¥</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">æœˆ</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">ç«</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">æ°´</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">æœ¨</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">é‡‘</div>
                        <div class="p-3 text-center font-semibold bg-blue-50 text-blue-800 rounded-lg">åœŸ</div>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-1" id="calendarGrid">
                        <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æ—¥ä»˜ã‚’å‹•çš„ã«ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
            
            <!-- ä»Šæ—¥ã®äºˆå®šè©³ç´° -->
            <div class="card p-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-4">ä»Šæ—¥ã®äºˆå®šè©³ç´°</h4>
                <div class="space-y-4">
                    <div class="p-4 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-12 border-l-4 border-blue-400">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-900">æœˆæ¬¡ä¼šè­°</div>
                                <div class="text-sm text-gray-600">10:00 - 12:00 | ä¼šè­°å®¤A</div>
                                <div class="text-xs text-blue-600 mt-1">å‚åŠ è€…: å·æº€ã•ã‚“ã€åº—é•·3å</div>
                            </div>
                            <span class="badge badge-blue">ä¼šè­°</span>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-gradient-to-r from-orange-50 to-amber-50 rounded-12 border-l-4 border-orange-400">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-900">å£²ä¸Šå ±å‘Šæå‡ºæœŸé™</div>
                                <div class="text-sm text-gray-600">17:00ã¾ã§ | å„åº—èˆ—</div>
                                <div class="text-xs text-orange-600 mt-1">åå¤å±‹ãƒ»éŒ¦ãƒ»æ¨ªæµœåº—</div>
                            </div>
                            <span class="badge badge-yellow">æå‡ºæœŸé™</span>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-12 border-l-4 border-green-400">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-900">ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³æ’®å½±ç¢ºèª</div>
                                <div class="text-sm text-gray-600">15:00 - 16:00 | åå¤å±‹åº—</div>
                                <div class="text-xs text-green-600 mt-1">ã‚«ãƒ¡ãƒ©ãƒãƒ³: ç”°ä¸­ã•ã‚“</div>
                            </div>
                            <span class="badge badge-green">æ’®å½±</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° ===
        let currentPage = 'dashboard';
        let sidebarOpen = false;
        let salesChart = null;
        let currentChartType = 'bar';
        
        // === åˆæœŸåŒ– ===
        document.addEventListener('DOMContentLoaded', function() {
            console.log('CLASSYæ¥­å‹™ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰èµ·å‹•');
            
            // æ™‚åˆ»æ›´æ–°
            updateDateTime();
            setInterval(updateDateTime, 60000);
            
            // ãƒãƒ£ãƒ¼ãƒˆåˆæœŸåŒ–
            initializeSalesChart();
            
            // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åˆæœŸåŒ–
            generateCalendar();
            
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒšãƒ¼ã‚¸è¡¨ç¤º
            showPage('dashboard');
            
            console.log('åˆæœŸåŒ–å®Œäº†');
        });
        
        // === ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ ===
        function toggleSidebar() {
            sidebarOpen = !sidebarOpen;
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (sidebarOpen) {
                sidebar.classList.add('active');
                overlay.classList.add('active');
            } else {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            }
        }
        
        function closeSidebar() {
            sidebarOpen = false;
            document.getElementById('sidebar').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }
        
        function showPage(pageName) {
            // ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã‚’éè¡¨ç¤º
            const pages = ['dashboard', 'sales', 'reports', 'calendar'];
            pages.forEach(page => {
                const pageElement = document.getElementById(page + 'Page');
                if (pageElement) {
                    pageElement.classList.add('hidden');
                }
            });
            
            // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // é¸æŠã•ã‚ŒãŸãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤º
            const targetPage = document.getElementById(pageName + 'Page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
                targetPage.classList.add('fade-in');
            }
            
            // å¯¾å¿œã™ã‚‹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
            const navItems = document.querySelectorAll('.nav-item');
            const pageIndex = pages.indexOf(pageName);
            if (pageIndex !== -1 && navItems[pageIndex]) {
                navItems[pageIndex].classList.add('active');
            }
            
            // ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ›´æ–°
            const pageTitles = {
                'dashboard': 'ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',
                'sales': 'å£²ä¸Šåˆ†æ',
                'reports': 'ä¼šè­°è³‡æ–™',
                'calendar': 'ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼'
            };
            const titleElement = document.getElementById('currentPageTitle');
            if (titleElement) {
                titleElement.textContent = pageTitles[pageName];
            }
            
            currentPage = pageName;
            
            // ãƒ¢ãƒã‚¤ãƒ«ã§ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’é–‰ã˜ã‚‹
            if (window.innerWidth < 768) {
                closeSidebar();
            }
        }
        
        // === æ—¥æ™‚æ›´æ–° ===
        function updateDateTime() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('ja-JP', { 
                year: 'numeric', 
                month: 'numeric', 
                day: 'numeric',
                weekday: 'short'
            });
            const timeStr = now.toLocaleTimeString('ja-JP', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            const currentDate = document.getElementById('currentDate');
            const currentTime = document.getElementById('currentTime');
            
            if (currentDate) currentDate.textContent = dateStr;
            if (currentTime) currentTime.textContent = timeStr;
            
            // æœ€çµ‚æ›´æ–°æ™‚åˆ»ã‚‚æ›´æ–°
            const lastUpdate = document.getElementById('lastUpdate');
            if (lastUpdate) {
                lastUpdate.textContent = now.toLocaleString('ja-JP', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
        }
        
        // === ã‚¿ã‚¹ã‚¯ç®¡ç† ===
        function toggleTask(checkbox) {
            const taskItem = checkbox.closest('.task-item');
            const taskText = taskItem.querySelector('.task-text');
            const badge = taskItem.querySelector('.badge');
            
            if (checkbox.checked) {
                taskItem.classList.add('task-completed');
                badge.textContent = 'å®Œäº†';
                badge.className = 'badge badge-green';
            } else {
                taskItem.classList.remove('task-completed');
                // å…ƒã®ãƒãƒƒã‚¸çŠ¶æ…‹ã«æˆ»ã™ï¼ˆç°¡æ˜“å®Ÿè£…ï¼‰
                badge.textContent = 'é€²è¡Œä¸­';
                badge.className = 'badge badge-yellow';
            }
        }
        
        function refreshTasks() {
            // Google Sheets ã‹ã‚‰ã‚¿ã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>æ›´æ–°ä¸­...';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                alert('ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’æ›´æ–°ã—ã¾ã—ãŸ');
            }, 1500);
        }
        
        // === Googleé€£æº ===
        function syncGoogleData() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>åŒæœŸä¸­...';
            btn.disabled = true;
            
            // Google Sheets & Calendar åŒæœŸã®æ¨¡æ“¬å‡¦ç†
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                
                // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                showNotification('Google ãƒ‡ãƒ¼ã‚¿ã®åŒæœŸãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
                
                // ãƒ‡ãƒ¼ã‚¿æ›´æ–°
                updateDateTime();
            }, 2000);
        }
        
        function syncGoogleCalendar() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>åŒæœŸä¸­...';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                showNotification('Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨åŒæœŸã—ã¾ã—ãŸ', 'success');
            }, 1500);
        }
        
        // === ãƒãƒ£ãƒ¼ãƒˆæ©Ÿèƒ½ ===
        function initializeSalesChart() {
            const ctx = document.getElementById('salesChart');
            if (!ctx) return;
            
            const data = {
                labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [{
                    label: 'å£²ä¸Šï¼ˆç™¾ä¸‡å††ï¼‰',
                    data: [245, 268, 225, 298, 275, 280],
                    backgroundColor: 'rgba(59, 130, 246, 0.8)',
                    borderColor: '#3b82f6',
                    borderWidth: 2,
                    tension: 0.3
                }, {
                    label: 'å‰å¹´åŒæœŸ',
                    data: [220, 235, 210, 265, 245, 249],
                    backgroundColor: 'rgba(6, 182, 212, 0.6)',
                    borderColor: '#06b6d4',
                    borderWidth: 2,
                    tension: 0.3
                }]
            };
            
            salesChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    }
                }
            });
        }
        
        function toggleChartType(type) {
            if (!salesChart) return;
            
            // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
            document.getElementById('lineChartBtn').className = type === 'line' ? 'btn btn-primary' : 'btn btn-outline';
            document.getElementById('barChartBtn').className = type === 'bar' ? 'btn btn-primary' : 'btn btn-outline';
            
            // ãƒãƒ£ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—å¤‰æ›´
            salesChart.config.type = type;
            salesChart.update('active');
            currentChartType = type;
        }
        
        // === ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ ===
        function downloadReport(reportType, format) {
            // ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ
            let data = [];
            let filename = '';
            
            switch(reportType) {
                case 'sales':
                    data = [
                        ['åº—èˆ—å', '1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', 'ç´¯è¨ˆ', 'é”æˆç‡'],
                        ['åå¤å±‹åº—', '105,200,000', '112,300,000', '98,500,000', '118,700,000', '108,900,000', '105,200,000', '648,800,000', '105.2%'],
                        ['éŒ¦åº—', '82,500,000', '88,700,000', '75,200,000', '95,100,000', '85,300,000', '88,700,000', '515,500,000', '88.7%'],
                        ['æ¨ªæµœåº—', '92,800,000', '98,100,000', '89,300,000', '102,500,000', '95,700,000', '98,100,000', '576,500,000', '98.1%'],
                        ['', '', '', '', '', '', '', '', ''],
                        ['åˆè¨ˆ', '280,500,000', '299,100,000', '263,000,000', '316,300,000', '289,900,000', '291,900,000', '1,740,700,000', '96.2%']
                    ];
                    filename = `å£²ä¸Šã¾ã¨ã‚è³‡æ–™_${new Date().getFullYear()}å¹´${new Date().getMonth() + 1}æœˆ`;
                    break;
                    
                case 'dormitory':
                    data = [
                        ['éƒ¨å±‹ç•ªå·', 'å…¥å±…è€…å', 'å…¥å±…æ—¥', 'é€€å»äºˆå®š', 'æ¸…æƒçŠ¶æ³', 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹', 'å‚™è€ƒ'],
                        ['101', 'ç”°ä¸­ ç¾å’²', '2024-01-15', '2024-07-15', 'å®Œäº†', 'é€€å»äºˆå®š', '7æœˆä¸­æ—¬é€€å»'],
                        ['102', 'ä½è—¤ èŠ±éŸ³', '2024-03-01', '-', 'å®Œäº†', 'å…¥å±…ä¸­', 'é•·æœŸå…¥å±…'],
                        ['103', 'éˆ´æœ¨ æ„›å­', '2024-02-10', '-', 'æœªå®Œäº†', 'å…¥å±…ä¸­', 'æ¸…æƒè¦'],
                        ['201', 'é«˜æ©‹ éº—å¥ˆ', '2024-04-01', '-', 'å®Œäº†', 'å…¥å±…ä¸­', 'æ–°è¦å…¥å±…'],
                        ['202', '', '', '', '', 'ç©ºå®¤', 'å‹Ÿé›†ä¸­']
                    ];
                    filename = `å¯®ç®¡ç†è³‡æ–™_${new Date().getFullYear()}å¹´${new Date().getMonth() + 1}æœˆ`;
                    break;
                    
                case 'posts':
                    data = [
                        ['åº—èˆ—å', 'ç›®æ¨™æŠ•ç¨¿æ•°', 'å®ŸæŠ•ç¨¿æ•°', 'é”æˆç‡', 'å‰æœˆæ¯”', 'æœªé”æˆè€…æ•°'],
                        ['åå¤å±‹åº—', '30', '24', '80%', '+5%', '2å'],
                        ['éŒ¦åº—', '30', '18', '60%', '-10%', '4å'],
                        ['æ¨ªæµœåº—', '30', '12', '40%', '-15%', '6å'],
                        ['', '', '', '', '', ''],
                        ['åˆè¨ˆ', '90', '54', '60%', '-7%', '12å']
                    ];
                    filename = `æŠ•ç¨¿ã¾ã¨ã‚è³‡æ–™_${new Date().getFullYear()}å¹´${new Date().getMonth() + 1}æœˆ`;
                    break;
                    
                case 'comprehensive':
                    data = [
                        ['é …ç›®', 'ç›®æ¨™', 'å®Ÿç¸¾', 'é”æˆç‡', 'å‰æœˆæ¯”', 'çŠ¶æ³'],
                        ['å£²ä¸Šï¼ˆåå¤å±‹ï¼‰', '100,000,000', '105,200,000', '105.2%', '+3.2%', 'ç›®æ¨™é”æˆ'],
                        ['å£²ä¸Šï¼ˆéŒ¦ï¼‰', '100,000,000', '88,700,000', '88.7%', '-5.1%', 'è¦æ”¹å–„'],
                        ['å£²ä¸Šï¼ˆæ¨ªæµœï¼‰', '100,000,000', '98,100,000', '98.1%', '+2.8%', 'é †èª¿'],
                        ['æŠ•ç¨¿ï¼ˆåå¤å±‹ï¼‰', '30', '24', '80%', '+5%', 'è‰¯å¥½'],
                        ['æŠ•ç¨¿ï¼ˆéŒ¦ï¼‰', '30', '18', '60%', '-10%', 'è¦æ³¨æ„'],
                        ['æŠ•ç¨¿ï¼ˆæ¨ªæµœï¼‰', '30', '12', '40%', '-15%', 'è¦æ”¹å–„'],
                        ['å¯®ç¨¼åƒç‡', '95%', '80%', '84.2%', '-2%', 'ç©ºå®¤æœ‰']
                    ];
                    filename = `ç·åˆãƒ¬ãƒãƒ¼ãƒˆ_${new Date().getFullYear()}å¹´${new Date().getMonth() + 1}æœˆ`;
                    break;
                    
                case 'schedule':
                    data = [
                        ['æ—¥ä»˜', 'æ›œæ—¥', 'æ™‚é–“', 'äºˆå®š', 'ã‚«ãƒ†ã‚´ãƒª', 'å ´æ‰€', 'å‚åŠ è€…'],
                        ['6/26', 'æœˆ', '10:00-12:00', 'æœˆæ¬¡ä¼šè­°', 'ä¼šè­°', 'ä¼šè­°å®¤A', 'å·æº€ã•ã‚“ã€åº—é•·3å'],
                        ['6/26', 'æœˆ', '17:00', 'å£²ä¸Šå ±å‘Šæå‡ºæœŸé™', 'æå‡ºæœŸé™', 'å„åº—èˆ—', 'å…¨åº—èˆ—'],
                        ['6/28', 'æ°´', '15:00-16:00', 'ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³æ’®å½±', 'æ’®å½±', 'åå¤å±‹åº—', 'ç”°ä¸­ã‚«ãƒ¡ãƒ©ãƒãƒ³'],
                        ['6/29', 'æœ¨', '14:00-15:00', 'çµ¦ä¸å‡¦ç†ç¢ºèª', 'æ¥­å‹™', 'æœ¬ç¤¾', 'çµŒç†æ‹…å½“'],
                        ['6/30', 'é‡‘', '10:00-12:00', 'ç›£æŸ»å¯¾å¿œ', 'ä¼šè­°', 'å…¨åº—èˆ—', 'ç›£æŸ»æ³•äºº']
                    ];
                    filename = `ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«_${new Date().getFullYear()}å¹´${new Date().getMonth() + 1}æœˆ`;
                    break;
                    
                default:
                    data = [['ãƒ‡ãƒ¼ã‚¿ãªã—']];
                    filename = 'ãƒ‡ãƒ¼ã‚¿';
            }
            
            if (format === 'excel') {
                // Excelå½¢å¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'ãƒ‡ãƒ¼ã‚¿');
                XLSX.writeFile(wb, `${filename}.xlsx`);
            } else {
                // PDFå½¢å¼ã®å ´åˆã¯ç°¡æ˜“çš„ã«CSVã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                const csvContent = data.map(row => row.join(',')).join('\n');
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `${filename}.csv`;
                link.click();
            }
            
            showNotification(`${filename}ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ`, 'success');
        }
        
        function downloadMonthEndReport() {
            // æœˆæœ«ãƒ‡ãƒ¼ã‚¿ä¸€æ‹¬å‡ºåŠ›
            const reports = ['sales', 'dormitory', 'posts', 'schedule'];
            
            showNotification('æœˆæœ«ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­...', 'info');
            
            reports.forEach((report, index) => {
                setTimeout(() => {
                    downloadReport(report, 'excel');
                    if (index === reports.length - 1) {
                        setTimeout(() => {
                            showNotification('æœˆæœ«ãƒ‡ãƒ¼ã‚¿ã®ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
                        }, 500);
                    }
                }, index * 500);
            });
        }
        
        // === ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æ©Ÿèƒ½ ===
        function generateCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            if (!calendarGrid) return;
            
            // 2024å¹´6æœˆã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ç”Ÿæˆ
            const days = [];
            for (let i = 1; i <= 30; i++) {
                const isToday = i === 26; // ä»Šæ—¥ã¯26æ—¥ã¨ã—ã¦è¨­å®š
                const events = getEventsForDay(i);
                
                days.push(`
                    <div class="calendar-day ${isToday ? 'calendar-today' : ''} rounded-lg min-h-20">
                        <div class="font-semibold ${isToday ? 'text-blue-800' : 'text-gray-800'} mb-1">${i}</div>
                        ${events.map(event => `<div class="event-item ${event.class}">${event.text}</div>`).join('')}
                    </div>
                `);
            }
            
            calendarGrid.innerHTML = days.join('');
        }
        
        function getEventsForDay(day) {
            const events = {
                26: [
                    { text: 'æœˆæ¬¡ä¼šè­°', class: 'event-meeting' },
                    { text: 'å£²ä¸Šå ±å‘Š', class: 'event-deadline' }
                ],
                28: [
                    { text: 'æ’®å½±', class: 'event-shooting' },
                    { text: 'åº—é•·ä¼šè­°', class: 'event-meeting' }
                ],
                29: [
                    { text: 'çµ¦ä¸å‡¦ç†', class: 'event-deadline' }
                ],
                30: [
                    { text: 'ç›£æŸ»', class: 'event-meeting' }
                ],
                1: [
                    { text: 'ä¼‘æ¥­æ—¥', class: 'event-holiday' }
                ],
                2: [
                    { text: 'ä¼‘æ¥­æ—¥', class: 'event-holiday' }
                ]
            };
            
            return events[day] || [];
        }
        
        function addEvent() {
            alert('äºˆå®šè¿½åŠ æ©Ÿèƒ½ï¼ˆGoogle Calendaré€£æºã§å®Ÿè£…äºˆå®šï¼‰');
        }
        
        function filterEvents(type) {
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
            document.querySelectorAll('[id^="filter"]').forEach(btn => {
                btn.className = 'btn btn-outline';
            });
            document.getElementById(`filter${type.charAt(0).toUpperCase() + type.slice(1)}`).className = 'btn btn-primary';
            
            // ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆå®Ÿè£…ä¾‹ï¼‰
            showNotification(`${type === 'all' ? 'å…¨äºˆå®š' : type === 'common' ? 'å…±é€šäºˆå®š' : 'å€‹åˆ¥äºˆå®š'}ã‚’è¡¨ç¤ºä¸­`, 'info');
        }
        
        function previousMonth() {
            showNotification('å‰æœˆè¡¨ç¤ºï¼ˆå®Ÿè£…äºˆå®šï¼‰', 'info');
        }
        
        function nextMonth() {
            showNotification('ç¿Œæœˆè¡¨ç¤ºï¼ˆå®Ÿè£…äºˆå®šï¼‰', 'info');
        }
        
        // === é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ  ===
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-100 text-green-800 border border-green-200' :
                type === 'error' ? 'bg-red-100 text-red-800 border border-red-200' :
                'bg-blue-100 text-blue-800 border border-blue-200'
            }`;
            
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // === ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ ===
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 768) {
                closeSidebar();
            }
        });
        
        console.log('CLASSYæ¥­å‹™ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - åˆæœŸåŒ–å®Œäº†');
    </script>
</body>
</html>
