<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLASSY業務ダッシュボード - 川満さん専用</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #3b82f6;
            --secondary-blue: #60a5fa;
            --light-blue: #dbeafe;
            --cyan: #06b6d4;
            --light-cyan: #cffafe;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid rgba(148, 163, 184, 0.1);
        }
        
        .card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            font-weight: 500;
            border-radius: 12px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 14px;
            min-height: 48px;
            min-width: 120px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
        }
        
        .btn-cyan {
            background: linear-gradient(135deg, var(--cyan), #22d3ee);
            color: white;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
        }
        
        .btn-cyan:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(6, 182, 212, 0.4);
        }
        
        .btn-outline {
            background: white;
            color: var(--primary-blue);
            border: 2px solid var(--light-blue);
        }
        
        .btn-outline:hover {
            background: var(--light-blue);
            border-color: var(--primary-blue);
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            margin: 4px 0;
            border-radius: 12px;
            color: #64748b;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            font-weight: 500;
        }
        
        .nav-item:hover {
            background: var(--light-blue);
            color: var(--primary-blue);
            transform: translateX(4px);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .stat-card {
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue), var(--cyan));
        }
        
        .stat-card:hover {
            transform: scale(1.02);
        }
        
        .progress-bar {
            background: #e2e8f0;
            border-radius: 8px;
            height: 8px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 8px;
            transition: width 0.5s ease;
        }
        
        .progress-green { background: linear-gradient(90deg, #10b981, #34d399); }
        .progress-yellow { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .progress-red { background: linear-gradient(90deg, #ef4444, #f87171); }
        
        .task-item {
            padding: 16px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            background: white;
        }
        
        .task-item:hover {
            border-color: var(--primary-blue);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
        }
        
        .task-completed {
            opacity: 0.6;
            background: #f8fafc;
        }
        
        .task-completed .task-text {
            text-decoration: line-through;
            color: #64748b;
        }
        
        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .badge-green { background: #dcfce7; color: #166534; }
        .badge-yellow { background: #fef3c7; color: #92400e; }
        .badge-red { background: #fecaca; color: #991b1b; }
        .badge-blue { background: var(--light-blue); color: var(--primary-blue); }
        .badge-cyan { background: var(--light-cyan); color: #0e7490; }
        
        .calendar-day {
            min-height: 80px;
            border: 1px solid #e2e8f0;
            padding: 8px;
            transition: all 0.3s ease;
            background: white;
        }
        
        .calendar-day:hover {
            background: #f8fafc;
            border-color: var(--primary-blue);
        }
        
        .calendar-today {
            background: var(--light-blue);
            border-color: var(--primary-blue);
            font-weight: 600;
        }
        
        .event-item {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            margin: 2px 0;
            font-weight: 500;
        }
        
        .event-meeting { background: var(--light-blue); color: var(--primary-blue); }
        .event-shooting { background: #dcfce7; color: #166534; }
        .event-holiday { background: #fecaca; color: #991b1b; }
        .event-deadline { background: #fed7aa; color: #9a3412; }
        
        .chart-container {
            position: relative;
            height: 350px;
            width: 100%;
        }
        
        .hidden { display: none !important; }
        
        .sidebar {
            position: fixed;
            top: 0;
            left: -320px;
            width: 320px;
            height: 100vh;
            background: white;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 4px 0 24px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar.active {
            left: 0;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        @media (min-width: 768px) {
            .sidebar {
                position: relative;
                left: 0;
                box-shadow: none;
                border-right: 1px solid #e2e8f0;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- オーバーレイ -->
    <div id="overlay" class="overlay" onclick="closeSidebar()"></div>
    
    <!-- サイドバー -->
    <div id="sidebar" class="sidebar">
        <div class="p-6">
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h2 class="text-xl font-bold text-gray-900">CLASSY</h2>
                    <p class="text-sm text-gray-600">業務ダッシュボード</p>
                    <p class="text-xs text-blue-600 font-medium">川満さん専用</p>
                </div>
                <button onclick="closeSidebar()" class="md:hidden text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <nav class="space-y-2">
                <div class="nav-item active" onclick="showPage('dashboard')">
                    <i class="fas fa-home mr-3 text-lg"></i>
                    <span>ダッシュボード</span>
                </div>
                <div class="nav-item" onclick="showPage('sales')">
                    <i class="fas fa-chart-line mr-3 text-lg"></i>
                    <span>売上分析</span>
                </div>
                <div class="nav-item" onclick="showPage('reports')">
                    <i class="fas fa-file-alt mr-3 text-lg"></i>
                    <span>会議資料</span>
                </div>
                <div class="nav-item" onclick="showPage('calendar')">
                    <i class="fas fa-calendar mr-3 text-lg"></i>
                    <span>カレンダー</span>
                </div>
            </nav>
            
            <div class="mt-8 p-4 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-12 border border-blue-100">
                <div class="text-center">
                    <div class="text-2xl mb-2">📊</div>
                    <p class="text-sm font-medium text-blue-800">データ最終更新</p>
                    <p class="text-xs text-blue-600" id="lastUpdate">2024-06-26 14:30</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- メインコンテンツ -->
    <div class="min-h-screen md:ml-320">
        <!-- ヘッダー -->
        <header class="card m-4 mb-6">
            <div class="p-4 flex items-center justify-between">
                <div class="flex items-center">
                    <button onclick="toggleSidebar()" class="md:hidden mr-4 text-gray-600 hover:text-gray-800">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">CLASSY業務ダッシュボード</h1>
                        <p class="text-sm text-gray-600" id="currentPageTitle">ダッシュボード</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="text-right hidden sm:block">
                        <div class="font-semibold text-gray-900" id="currentDate"></div>
                        <div class="text-sm text-blue-600" id="currentTime"></div>
                    </div>
                    <button class="btn btn-primary" onclick="syncGoogleData()">
                        <i class="fas fa-sync-alt mr-2"></i>
                        <span class="hidden sm:inline">Google同期</span>
                    </button>
                </div>
            </div>
        </header>
        
        <!-- ダッシュボードページ -->
        <div id="dashboardPage" class="page-content px-4 fade-in">
            <!-- 本日のやることリスト -->
            <div class="card p-6 mb-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-tasks mr-3 text-blue-600"></i>本日のやることリスト
                    </h3>
                    <button class="btn btn-outline" onclick="refreshTasks()">
                        <i class="fas fa-refresh mr-2"></i>更新
                    </button>
                </div>
                <div id="todayTasks" class="space-y-3">
                    <div class="task-item">
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-4 w-5 h-5 text-blue-600 rounded" onchange="toggleTask(this)">
                            <div class="flex-1">
                                <div class="task-text font-medium">寮の退去確認（田中さん）</div>
                                <div class="text-sm text-gray-500">10:00 - 優先度：高</div>
                            </div>
                            <span class="badge badge-red">重要</span>
                        </div>
                    </div>
                    <div class="task-item">
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-4 w-5 h-5 text-blue-600 rounded" onchange="toggleTask(this)">
                            <div class="flex-1">
                                <div class="task-text font-medium">名古屋店売上確認・分析</div>
                                <div class="text-sm text-gray-500">15:00 - スプレッドシート更新</div>
                            </div>
                            <span class="badge badge-yellow">通常</span>
                        </div>
                    </div>
                    <div class="task-item task-completed">
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-4 w-5 h-5 text-blue-600 rounded" checked onchange="toggleTask(this)">
                            <div class="flex-1">
                                <div class="task-text font-medium">投稿状況チェック（全店舗）</div>
                                <div class="text-sm text-gray-500">09:00 - 完了済み</div>
                            </div>
                            <span class="badge badge-green">完了</span>
                        </div>
                    </div>
                    <div class="task-item">
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-4 w-5 h-5 text-blue-600 rounded" onchange="toggleTask(this)">
                            <div class="flex-1">
                                <div class="task-text font-medium">会議資料準備（月次レポート）</div>
                                <div class="text-sm text-gray-500">17:00 - 明日の会議用</div>
                            </div>
                            <span class="badge badge-blue">会議</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 店舗別投稿状況・売上速報 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="card p-6">
                    <h3 class="text-lg font-semibold mb-6 text-gray-900 flex items-center">
                        <i class="fas fa-camera mr-3 text-green-600"></i>店舗別投稿状況
                    </h3>
                    <div class="space-y-4">
                        <div class="p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-12 border border-green-100">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-gray-900">名古屋店</span>
                                <span class="text-green-600 font-bold">24/30</span>
                            </div>
                            <div class="progress-bar mb-2">
                                <div class="progress-fill progress-green" style="width: 80%"></div>
                            </div>
                            <div class="text-sm text-gray-600">達成率: 80% | 目標まで6件</div>
                        </div>
                        
                        <div class="p-4 bg-gradient-to-r from-yellow-50 to-amber-50 rounded-12 border border-yellow-100">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-gray-900">錦店</span>
                                <span class="text-yellow-600 font-bold">18/30</span>
                            </div>
                            <div class="progress-bar mb-2">
                                <div class="progress-fill progress-yellow" style="width: 60%"></div>
                            </div>
                            <div class="text-sm text-gray-600">達成率: 60% | 目標まで12件</div>
                        </div>
                        
                        <div class="p-4 bg-gradient-to-r from-red-50 to-rose-50 rounded-12 border border-red-100">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-gray-900">横浜店</span>
                                <span class="text-red-600 font-bold">12/30</span>
                            </div>
                            <div class="progress-bar mb-2">
                                <div class="progress-fill progress-red" style="width: 40%"></div>
                            </div>
                            <div class="text-sm text-gray-600">達成率: 40% | 目標まで18件</div>
                        </div>
                    </div>
                </div>
                
                <!-- 売上速報 -->
                <div class="card p-6">
                    <h3 class="text-lg font-semibold mb-6 text-gray-900 flex items-center">
                        <i class="fas fa-yen-sign mr-3 text-blue-600"></i>本日の売上速報
                    </h3>
                    <div class="space-y-4">
                        <div class="stat-card bg-gradient-to-br from-blue-50 to-cyan-50 rounded-12 border border-blue-100">
                            <div class="text-3xl font-bold text-blue-600">¥2,680,000</div>
                            <div class="text-sm text-blue-800 font-medium">本日の総売上</div>
                            <div class="text-xs text-green-600 mt-2 flex items-center justify-center">
                                <i class="fas fa-arrow-up mr-1"></i>昨日比 +15.2%
                            </div>
                        </div>
                        
                        <div class="stat-card bg-gradient-to-br from-green-50 to-emerald-50 rounded-12 border border-green-100">
                            <div class="text-2xl font-bold text-green-600">¥82,500,000</div>
                            <div class="text-sm text-green-800 font-medium">今月累計</div>
                            <div class="text-xs text-green-600 mt-2">目標達成率: 92.1%</div>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div class="p-3 bg-white rounded-lg border border-gray-100">
                                <div class="text-lg font-bold text-purple-600">¥950K</div>
                                <div class="text-xs text-gray-600">名古屋</div>
                            </div>
                            <div class="p-3 bg-white rounded-lg border border-gray-100">
                                <div class="text-lg font-bold text-indigo-600">¥820K</div>
                                <div class="text-xs text-gray-600">錦</div>
                            </div>
                            <div class="p-3 bg-white rounded-lg border border-gray-100">
                                <div class="text-lg font-bold text-pink-600">¥910K</div>
                                <div class="text-xs text-gray-600">横浜</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 今週の予定 -->
            <div class="card p-6">
                <h3 class="text-lg font-semibold mb-6 text-gray-900 flex items-center">
                    <i class="fas fa-calendar mr-3 text-indigo-600"></i>今週の予定
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-7 gap-3">
                    <div class="calendar-day calendar-today rounded-12">
                        <div class="font-semibold text-blue-800 mb-2">月 26</div>
                        <div class="event-item event-meeting">月次会議</div>
                        <div class="event-item event-deadline">売上報告</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-gray-800 mb-2">火 27</div>
                        <div class="text-sm text-gray-500">予定なし</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-gray-800 mb-2">水 28</div>
                        <div class="event-item event-shooting">撮影</div>
                        <div class="event-item event-meeting">店長会議</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-gray-800 mb-2">木 29</div>
                        <div class="event-item event-deadline">給与処理</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-gray-800 mb-2">金 30</div>
                        <div class="event-item event-meeting">監査</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-red-800 mb-2">土 1</div>
                        <div class="event-item event-holiday">休業日</div>
                    </div>
                    <div class="calendar-day rounded-12">
                        <div class="font-semibold text-red-800 mb-2">日 2</div>
                        <div class="event-item event-holiday">休業日</div>
                    </div>
                </div>
                
                <div class="mt-6 flex flex-wrap gap-4 text-sm">
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-blue-400 rounded mr-2"></div>
                        <span>会議</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-green-400 rounded mr-2"></div>
                        <span>撮影</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-red-400 rounded mr-2"></div>
                        <span>休業</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-orange-400 rounded mr-2"></div>
                        <span>提出期限</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 売上分析ページ -->
        <div id="salesPage" class="page-content px-4 hidden">
            <!-- 統計カード -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <div class="card stat-card bg-gradient-to-br from-blue-50 to-cyan-50">
                    <div class="text-3xl font-bold text-blue-600">¥280M</div>
                    <div class="text-sm text-blue-800 font-medium">今月売上</div>
                    <div class="text-xs text-green-600 mt-2 flex items-center justify-center">
                        <i class="fas fa-arrow-up mr-1"></i>前年同期比 +12.5%
                    </div>
                </div>
                <div class="card stat-card bg-gradient-to-br from-green-50 to-emerald-50">
                    <div class="text-3xl font-bold text-green-600">96.2%</div>
                    <div class="text-sm text-green-800 font-medium">目標達成率</div>
                    <div class="text-xs text-green-600 mt-2">目標: ¥291M</div>
                </div>
                <div class="card stat-card bg-gradient-to-br from-purple-50 to-violet-50">
                    <div class="text-3xl font-bold text-purple-600">3/3</div>
                    <div class="text-sm text-purple-800 font-medium">目標達成店舗</div>
                    <div class="text-xs text-purple-600 mt-2">全店舗達成中</div>
                </div>
                <div class="card stat-card bg-gradient-to-br from-orange-50 to-amber-50">
                    <div class="text-3xl font-bold text-orange-600">¥93.3M</div>
                    <div class="text-sm text-orange-800 font-medium">店舗平均売上</div>
                    <div class="text-xs text-orange-600 mt-2">月平均</div>
                </div>
            </div>
            
            <!-- グラフセクション -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="card p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h4 class="text-lg font-semibold text-gray-900">月別・週別売上推移</h4>
                        <div class="flex space-x-2">
                            <button class="btn btn-outline" onclick="toggleChartType('line')" id="lineChartBtn">線グラフ</button>
                            <button class="btn btn-primary" onclick="toggleChartType('bar')" id="barChartBtn">棒グラフ</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
                
                <div class="card p-6">
                    <h4 class="text-lg font-semibold text-gray-900 mb-6">店舗別ランキング（当月売上）</h4>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gradient-to-r from-yellow-50 to-amber-50 rounded-12 border-l-4 border-yellow-400">
                            <div class="flex items-center">
                                <div class="text-2xl mr-3">🥇</div>
                                <div>
                                    <div class="font-semibold text-gray-900">名古屋店</div>
                                    <div class="text-sm text-gray-600">達成率: 105.2%</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-yellow-600 text-lg">¥105.2M</div>
                                <div class="text-xs text-green-600">+5.2%</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-gradient-to-r from-gray-50 to-slate-50 rounded-12 border-l-4 border-gray-400">
                            <div class="flex items-center">
                                <div class="text-2xl mr-3">🥈</div>
                                <div>
                                    <div class="font-semibold text-gray-900">横浜店</div>
                                    <div class="text-sm text-gray-600">達成率: 98.1%</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-gray-600 text-lg">¥98.1M</div>
                                <div class="text-xs text-yellow-600">-1.9%</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-gradient-to-r from-orange-50 to-amber-50 rounded-12 border-l-4 border-orange-400">
                            <div class="flex items-center">
                                <div class="text-2xl mr-3">🥉</div>
                                <div>
                                    <div class="font-semibold text-gray-900">錦店</div>
                                    <div class="text-sm text-gray-600">達成率: 88.7%</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-orange-600 text-lg">¥88.7M</div>
                                <div class="text-xs text-red-600">-11.3%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 bg-blue-50 rounded-12 border border-blue-100">
                        <div class="text-sm font-medium text-blue-800 mb-2">前年同期比較</div>
                        <div class="text-xs text-blue-600">
                            <i class="fas fa-arrow-up mr-1"></i>全店舗合計: +12.5% (前年同月: ¥249M)
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 売上目標達成率 -->
            <div class="card p-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-6">売上目標達成率（色分け表示）</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="p-6 bg-gradient-to-br from-green-50 to-emerald-50 rounded-16 border-2 border-green-200">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-600">105.2%</div>
                            <div class="text-lg font-semibold text-gray-900 mt-2">名古屋店</div>
                            <div class="badge badge-green mt-3">目標達成</div>
                            <div class="text-sm text-gray-600 mt-2">目標: ¥100M / 実績: ¥105.2M</div>
                        </div>
                    </div>
                    
                    <div class="p-6 bg-gradient-to-br from-yellow-50 to-amber-50 rounded-16 border-2 border-yellow-200">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-yellow-600">88.7%</div>
                            <div class="text-lg font-semibold text-gray-900 mt-2">錦店</div>
                            <div class="badge badge-yellow mt-3">要注意</div>
                            <div class="text-sm text-gray-600 mt-2">目標: ¥100M / 実績: ¥88.7M</div>
                        </div>
                    </div>
                    
                    <div class="p-6 bg-gradient-to-br from-green-50 to-emerald-50 rounded-16 border-2 border-green-200">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-600">98.1%</div>
                            <div class="text-lg font-semibold text-gray-900 mt-2">横浜店</div>
                            <div class="badge badge-green mt-3">順調</div>
                            <div class="text-sm text-gray-600 mt-2">目標: ¥100M / 実績: ¥98.1M</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 会議資料ページ -->
        <div id="reportsPage" class="page-content px-4 hidden">
            <div class="card p-6 mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-6">会議資料ダウンロード</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">📊</div>
                        <h4 class="font-semibold text-lg mb-2">売上まとめ資料</h4>
                        <p class="text-sm text-gray-600 mb-4">月別・店舗別売上データと分析</p>
                        <div class="space-y-2">
                            <button class="btn btn-primary w-full" onclick="downloadReport('sales', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excel形式
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('sales', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDF形式
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">🏠</div>
                        <h4 class="font-semibold text-lg mb-2">寮管理資料</h4>
                        <p class="text-sm text-gray-600 mb-4">入居状況・退去予定・管理状況</p>
                        <div class="space-y-2">
                            <button class="btn btn-primary w-full" onclick="downloadReport('dormitory', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excel形式
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('dormitory', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDF形式
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">📱</div>
                        <h4 class="font-semibold text-lg mb-2">投稿まとめ資料</h4>
                        <p class="text-sm text-gray-600 mb-4">投稿数・達成率・分析データ</p>
                        <div class="space-y-2">
                            <button class="btn btn-primary w-full" onclick="downloadReport('posts', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excel形式
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('posts', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDF形式
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">📋</div>
                        <h4 class="font-semibold text-lg mb-2">総合レポート</h4>
                        <p class="text-sm text-gray-600 mb-4">全業務統合・経営会議用</p>
                        <div class="space-y-2">
                            <button class="btn btn-cyan w-full" onclick="downloadReport('comprehensive', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excel形式
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('comprehensive', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDF形式
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">📅</div>
                        <h4 class="font-semibold text-lg mb-2">スケジュール資料</h4>
                        <p class="text-sm text-gray-600 mb-4">予定表・会議・撮影スケジュール</p>
                        <div class="space-y-2">
                            <button class="btn btn-primary w-full" onclick="downloadReport('schedule', 'excel')">
                                <i class="fas fa-file-excel mr-2"></i>Excel形式
                            </button>
                            <button class="btn btn-outline w-full" onclick="downloadReport('schedule', 'pdf')">
                                <i class="fas fa-file-pdf mr-2"></i>PDF形式
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-5xl mb-4">🎯</div>
                        <h4 class="font-semibold text-lg mb-2">月末データ</h4>
                        <p class="text-sm text-gray-600 mb-4">月末締め・全データ一括出力</p>
                        <div class="space-y-2">
                            <button class="btn btn-cyan w-full" onclick="downloadMonthEndReport()">
                                <i class="fas fa-download mr-2"></i>一括ダウンロード
                            </button>
                            <div class="text-xs text-gray-500 mt-2">
                                売上・寮・投稿・スケジュール
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 最近のダウンロード履歴 -->
            <div class="card p-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-4">最近のダウンロード履歴</h4>
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-file-excel text-green-600 mr-3"></i>
                            <div>
                                <div class="font-medium">売上まとめ資料_2024年6月.xlsx</div>
                                <div class="text-sm text-gray-500">2024-06-26 14:30</div>
                            </div>
                        </div>
                        <button class="text-blue-600 hover:text-blue-800">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-file-pdf text-red-600 mr-3"></i>
                            <div>
                                <div class="font-medium">総合レポート_2024年6月.pdf</div>
                                <div class="text-sm text-gray-500">2024-06-25 16:45</div>
                            </div>
                        </div>
                        <button class="text-blue-600 hover:text-blue-800">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- カレンダーページ -->
        <div id="calendarPage" class="page-content px-4 hidden">
            <div class="card p-6 mb-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4 md:mb-0">カレンダー</h3>
                    <div class="flex flex-wrap gap-2">
                        <button class="btn btn-primary" onclick="addEvent()">
                            <i class="fas fa-plus mr-2"></i>予定追加
                        </button>
                        <button class="btn btn-outline" onclick="filterEvents('all')" id="filterAll">全予定</button>
                        <button class="btn btn-outline" onclick="filterEvents('common')" id="filterCommon">共通予定</button>
                        <button class="btn btn-outline" onclick="filterEvents('individual')" id="filterIndividual">個別予定</button>
                        <button class="btn btn-cyan" onclick="syncGoogleCalendar()">
                            <i class="fas fa-sync mr-2"></i>Google同期
                        </button>
                    </div>
                </div>
                
                <!-- カレンダー表示 -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="text-xl font-semibold text-gray-900">2024年6月</h4>
                        <div class="flex space-x-2">
                            <button class="btn btn-outline" onclick="previousMonth()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="btn btn-outline" onclick="nextMonth()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-1 mb-2">
                        <div class="p-3 text-center font-semibold bg-red-50 text-red-800 rounded-lg">日</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">月</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">火</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">水</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">木</div>
                        <div class="p-3 text-center font-semibold bg-gray-50 rounded-lg">金</div>
                        <div class="p-3 text-center font-semibold bg-blue-50 text-blue-800 rounded-lg">土</div>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-1" id="calendarGrid">
                        <!-- カレンダーの日付を動的に生成 -->
                    </div>
                </div>
            </div>
            
            <!-- 今日の予定詳細 -->
            <div class="card p-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-4">今日の予定詳細</h4>
                <div class="space-y-4">
                    <div class="p-4 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-12 border-l-4 border-blue-400">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-900">月次会議</div>
                                <div class="text-sm text-gray-600">10:00 - 12:00 | 会議室A</div>
                                <div class="text-xs text-blue-600 mt-1">参加者: 川満さん、店長3名</div>
                            </div>
                            <span class="badge badge-blue">会議</span>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-gradient-to-r from-orange-50 to-amber-50 rounded-12 border-l-4 border-orange-400">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-900">売上報告提出期限</div>
                                <div class="text-sm text-gray-600">17:00まで | 各店舗</div>
                                <div class="text-xs text-orange-600 mt-1">名古屋・錦・横浜店</div>
                            </div>
                            <span class="badge badge-yellow">提出期限</span>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-12 border-l-4 border-green-400">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-900">プロモーション撮影確認</div>
                                <div class="text-sm text-gray-600">15:00 - 16:00 | 名古屋店</div>
                                <div class="text-xs text-green-600 mt-1">カメラマン: 田中さん</div>
                            </div>
                            <span class="badge badge-green">撮影</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === グローバル変数 ===
        let currentPage = 'dashboard';
        let sidebarOpen = false;
        let salesChart = null;
        let currentChartType = 'bar';
        
        // === 初期化 ===
        document.addEventListener('DOMContentLoaded', function() {
            console.log('CLASSY業務ダッシュボード起動');
            
            // 時刻更新
            updateDateTime();
            setInterval(updateDateTime, 60000);
            
            // チャート初期化
            initializeSalesChart();
            
            // カレンダー初期化
            generateCalendar();
            
            // デフォルトページ表示
            showPage('dashboard');
            
            console.log('初期化完了');
        });
        
        // === ナビゲーション ===
        function toggleSidebar() {
            sidebarOpen = !sidebarOpen;
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (sidebarOpen) {
                sidebar.classList.add('active');
                overlay.classList.add('active');
            } else {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            }
        }
        
        function closeSidebar() {
            sidebarOpen = false;
            document.getElementById('sidebar').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }
        
        function showPage(pageName) {
            // すべてのページを非表示
            const pages = ['dashboard', 'sales', 'reports', 'calendar'];
            pages.forEach(page => {
                const pageElement = document.getElementById(page + 'Page');
                if (pageElement) {
                    pageElement.classList.add('hidden');
                }
            });
            
            // ナビゲーションのアクティブ状態をリセット
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // 選択されたページを表示
            const targetPage = document.getElementById(pageName + 'Page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
                targetPage.classList.add('fade-in');
            }
            
            // 対応するナビゲーションアイテムをアクティブに
            const navItems = document.querySelectorAll('.nav-item');
            const pageIndex = pages.indexOf(pageName);
            if (pageIndex !== -1 && navItems[pageIndex]) {
                navItems[pageIndex].classList.add('active');
            }
            
            // ページタイトルを更新
            const pageTitles = {
                'dashboard': 'ダッシュボード',
                'sales': '売上分析',
                'reports': '会議資料',
                'calendar': 'カレンダー'
            };
            const titleElement = document.getElementById('currentPageTitle');
            if (titleElement) {
                titleElement.textContent = pageTitles[pageName];
            }
            
            currentPage = pageName;
            
            // モバイルでサイドバーを閉じる
            if (window.innerWidth < 768) {
                closeSidebar();
            }
        }
        
        // === 日時更新 ===
        function updateDateTime() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('ja-JP', { 
                year: 'numeric', 
                month: 'numeric', 
                day: 'numeric',
                weekday: 'short'
            });
            const timeStr = now.toLocaleTimeString('ja-JP', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            const currentDate = document.getElementById('currentDate');
            const currentTime = document.getElementById('currentTime');
            
            if (currentDate) currentDate.textContent = dateStr;
            if (currentTime) currentTime.textContent = timeStr;
            
            // 最終更新時刻も更新
            const lastUpdate = document.getElementById('lastUpdate');
            if (lastUpdate) {
                lastUpdate.textContent = now.toLocaleString('ja-JP', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
        }
        
        // === タスク管理 ===
        function toggleTask(checkbox) {
            const taskItem = checkbox.closest('.task-item');
            const taskText = taskItem.querySelector('.task-text');
            const badge = taskItem.querySelector('.badge');
            
            if (checkbox.checked) {
                taskItem.classList.add('task-completed');
                badge.textContent = '完了';
                badge.className = 'badge badge-green';
            } else {
                taskItem.classList.remove('task-completed');
                // 元のバッジ状態に戻す（簡易実装）
                badge.textContent = '進行中';
                badge.className = 'badge badge-yellow';
            }
        }
        
        function refreshTasks() {
            // Google Sheets からタスクデータを更新
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>更新中...';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                alert('タスクリストを更新しました');
            }, 1500);
        }
        
        // === Google連携 ===
        function syncGoogleData() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>同期中...';
            btn.disabled = true;
            
            // Google Sheets & Calendar 同期の模擬処理
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                
                // 成功メッセージ
                showNotification('Google データの同期が完了しました', 'success');
                
                // データ更新
                updateDateTime();
            }, 2000);
        }
        
        function syncGoogleCalendar() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>同期中...';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                showNotification('Googleカレンダーと同期しました', 'success');
            }, 1500);
        }
        
        // === チャート機能 ===
        function initializeSalesChart() {
            const ctx = document.getElementById('salesChart');
            if (!ctx) return;
            
            const data = {
                labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                datasets: [{
                    label: '売上（百万円）',
                    data: [245, 268, 225, 298, 275, 280],
                    backgroundColor: 'rgba(59, 130, 246, 0.8)',
                    borderColor: '#3b82f6',
                    borderWidth: 2,
                    tension: 0.3
                }, {
                    label: '前年同期',
                    data: [220, 235, 210, 265, 245, 249],
                    backgroundColor: 'rgba(6, 182, 212, 0.6)',
                    borderColor: '#06b6d4',
                    borderWidth: 2,
                    tension: 0.3
                }]
            };
            
            salesChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    }
                }
            });
        }
        
        function toggleChartType(type) {
            if (!salesChart) return;
            
            // ボタンの状態更新
            document.getElementById('lineChartBtn').className = type === 'line' ? 'btn btn-primary' : 'btn btn-outline';
            document.getElementById('barChartBtn').className = type === 'bar' ? 'btn btn-primary' : 'btn btn-outline';
            
            // チャートタイプ変更
            salesChart.config.type = type;
            salesChart.update('active');
            currentChartType = type;
        }
        
        // === レポート機能 ===
        function downloadReport(reportType, format) {
            // レポートデータの生成
            let data = [];
            let filename = '';
            
            switch(reportType) {
                case 'sales':
                    data = [
                        ['店舗名', '1月', '2月', '3月', '4月', '5月', '6月', '累計', '達成率'],
                        ['名古屋店', '105,200,000', '112,300,000', '98,500,000', '118,700,000', '108,900,000', '105,200,000', '648,800,000', '105.2%'],
                        ['錦店', '82,500,000', '88,700,000', '75,200,000', '95,100,000', '85,300,000', '88,700,000', '515,500,000', '88.7%'],
                        ['横浜店', '92,800,000', '98,100,000', '89,300,000', '102,500,000', '95,700,000', '98,100,000', '576,500,000', '98.1%'],
                        ['', '', '', '', '', '', '', '', ''],
                        ['合計', '280,500,000', '299,100,000', '263,000,000', '316,300,000', '289,900,000', '291,900,000', '1,740,700,000', '96.2%']
                    ];
                    filename = `売上まとめ資料_${new Date().getFullYear()}年${new Date().getMonth() + 1}月`;
                    break;
                    
                case 'dormitory':
                    data = [
                        ['部屋番号', '入居者名', '入居日', '退去予定', '清掃状況', 'ステータス', '備考'],
                        ['101', '田中 美咲', '2024-01-15', '2024-07-15', '完了', '退去予定', '7月中旬退去'],
                        ['102', '佐藤 花音', '2024-03-01', '-', '完了', '入居中', '長期入居'],
                        ['103', '鈴木 愛子', '2024-02-10', '-', '未完了', '入居中', '清掃要'],
                        ['201', '高橋 麗奈', '2024-04-01', '-', '完了', '入居中', '新規入居'],
                        ['202', '', '', '', '', '空室', '募集中']
                    ];
                    filename = `寮管理資料_${new Date().getFullYear()}年${new Date().getMonth() + 1}月`;
                    break;
                    
                case 'posts':
                    data = [
                        ['店舗名', '目標投稿数', '実投稿数', '達成率', '前月比', '未達成者数'],
                        ['名古屋店', '30', '24', '80%', '+5%', '2名'],
                        ['錦店', '30', '18', '60%', '-10%', '4名'],
                        ['横浜店', '30', '12', '40%', '-15%', '6名'],
                        ['', '', '', '', '', ''],
                        ['合計', '90', '54', '60%', '-7%', '12名']
                    ];
                    filename = `投稿まとめ資料_${new Date().getFullYear()}年${new Date().getMonth() + 1}月`;
                    break;
                    
                case 'comprehensive':
                    data = [
                        ['項目', '目標', '実績', '達成率', '前月比', '状況'],
                        ['売上（名古屋）', '100,000,000', '105,200,000', '105.2%', '+3.2%', '目標達成'],
                        ['売上（錦）', '100,000,000', '88,700,000', '88.7%', '-5.1%', '要改善'],
                        ['売上（横浜）', '100,000,000', '98,100,000', '98.1%', '+2.8%', '順調'],
                        ['投稿（名古屋）', '30', '24', '80%', '+5%', '良好'],
                        ['投稿（錦）', '30', '18', '60%', '-10%', '要注意'],
                        ['投稿（横浜）', '30', '12', '40%', '-15%', '要改善'],
                        ['寮稼働率', '95%', '80%', '84.2%', '-2%', '空室有']
                    ];
                    filename = `総合レポート_${new Date().getFullYear()}年${new Date().getMonth() + 1}月`;
                    break;
                    
                case 'schedule':
                    data = [
                        ['日付', '曜日', '時間', '予定', 'カテゴリ', '場所', '参加者'],
                        ['6/26', '月', '10:00-12:00', '月次会議', '会議', '会議室A', '川満さん、店長3名'],
                        ['6/26', '月', '17:00', '売上報告提出期限', '提出期限', '各店舗', '全店舗'],
                        ['6/28', '水', '15:00-16:00', 'プロモーション撮影', '撮影', '名古屋店', '田中カメラマン'],
                        ['6/29', '木', '14:00-15:00', '給与処理確認', '業務', '本社', '経理担当'],
                        ['6/30', '金', '10:00-12:00', '監査対応', '会議', '全店舗', '監査法人']
                    ];
                    filename = `スケジュール_${new Date().getFullYear()}年${new Date().getMonth() + 1}月`;
                    break;
                    
                default:
                    data = [['データなし']];
                    filename = 'データ';
            }
            
            if (format === 'excel') {
                // Excel形式でダウンロード
                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'データ');
                XLSX.writeFile(wb, `${filename}.xlsx`);
            } else {
                // PDF形式の場合は簡易的にCSVでダウンロード
                const csvContent = data.map(row => row.join(',')).join('\n');
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `${filename}.csv`;
                link.click();
            }
            
            showNotification(`${filename}をダウンロードしました`, 'success');
        }
        
        function downloadMonthEndReport() {
            // 月末データ一括出力
            const reports = ['sales', 'dormitory', 'posts', 'schedule'];
            
            showNotification('月末データを一括ダウンロード中...', 'info');
            
            reports.forEach((report, index) => {
                setTimeout(() => {
                    downloadReport(report, 'excel');
                    if (index === reports.length - 1) {
                        setTimeout(() => {
                            showNotification('月末データの一括ダウンロードが完了しました', 'success');
                        }, 500);
                    }
                }, index * 500);
            });
        }
        
        // === カレンダー機能 ===
        function generateCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            if (!calendarGrid) return;
            
            // 2024年6月のカレンダーを生成
            const days = [];
            for (let i = 1; i <= 30; i++) {
                const isToday = i === 26; // 今日は26日として設定
                const events = getEventsForDay(i);
                
                days.push(`
                    <div class="calendar-day ${isToday ? 'calendar-today' : ''} rounded-lg min-h-20">
                        <div class="font-semibold ${isToday ? 'text-blue-800' : 'text-gray-800'} mb-1">${i}</div>
                        ${events.map(event => `<div class="event-item ${event.class}">${event.text}</div>`).join('')}
                    </div>
                `);
            }
            
            calendarGrid.innerHTML = days.join('');
        }
        
        function getEventsForDay(day) {
            const events = {
                26: [
                    { text: '月次会議', class: 'event-meeting' },
                    { text: '売上報告', class: 'event-deadline' }
                ],
                28: [
                    { text: '撮影', class: 'event-shooting' },
                    { text: '店長会議', class: 'event-meeting' }
                ],
                29: [
                    { text: '給与処理', class: 'event-deadline' }
                ],
                30: [
                    { text: '監査', class: 'event-meeting' }
                ],
                1: [
                    { text: '休業日', class: 'event-holiday' }
                ],
                2: [
                    { text: '休業日', class: 'event-holiday' }
                ]
            };
            
            return events[day] || [];
        }
        
        function addEvent() {
            alert('予定追加機能（Google Calendar連携で実装予定）');
        }
        
        function filterEvents(type) {
            // フィルターボタンの状態更新
            document.querySelectorAll('[id^="filter"]').forEach(btn => {
                btn.className = 'btn btn-outline';
            });
            document.getElementById(`filter${type.charAt(0).toUpperCase() + type.slice(1)}`).className = 'btn btn-primary';
            
            // イベントフィルタリング（実装例）
            showNotification(`${type === 'all' ? '全予定' : type === 'common' ? '共通予定' : '個別予定'}を表示中`, 'info');
        }
        
        function previousMonth() {
            showNotification('前月表示（実装予定）', 'info');
        }
        
        function nextMonth() {
            showNotification('翌月表示（実装予定）', 'info');
        }
        
        // === 通知システム ===
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-100 text-green-800 border border-green-200' :
                type === 'error' ? 'bg-red-100 text-red-800 border border-red-200' :
                'bg-blue-100 text-blue-800 border border-blue-200'
            }`;
            
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // === レスポンシブ対応 ===
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 768) {
                closeSidebar();
            }
        });
        
        console.log('CLASSY業務ダッシュボード - 初期化完了');
    </script>
</body>
</html>
